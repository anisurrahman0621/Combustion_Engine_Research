function Q = Rot_to_Quat(R)
A=0.25*[1 1 1 1;1 -1 -1 1;-1 1 -1 1;-1 -1 1 1];
b=[R(1,1) R(2,2) R(3,3) 1]';
q=A*b;
q0=q(1);
q1=q(2);
q2=q(3);
q3=q(4);
if q0==max(q)
    Q0=sqrt(q0);
    Q1=(R(3,2)-R(2,3))/(4*Q0);
    Q2=(R(1,3)-R(3,1))/(4*Q0);
    Q3=(R(2,1)-R(1,2))/(4*Q0);
else if q1==max(q)
    Q1=sqrt(q1);
    Q0=(R(3,2)-R(2,3))/(4*Q1);
    Q2=(R(1,2)+R(2,1))/(4*Q1);
    Q3=(R(1,3)+R(3,1))/(4*Q1);
    else if q2==max(q)
            Q2=sqrt(q2);
            Q0=(R(1,3)-R(3,1))/(4*Q2);
            Q1=(R(1,2)+R(2,1))/(4*Q2);
            Q3=(R(2,3)+R(3,2))/(4*Q2);
        else
                Q3=sqrt(q3);
                Q0=(R(2,1)-R(1,2))/(4*Q3);
                Q1=(R(1,3)+R(3,1))/(4*Q3);
                Q2=(R(2,3)+R(3,2))/(4*Q3);
            end
        end
    end

Q=[Q0 Q1 Q2 Q3];
    

    
end